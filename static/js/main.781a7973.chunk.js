(this.webpackJsonpmineswpr=this.webpackJsonpmineswpr||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(5),r=n.n(s),l=n(1),o=n(2),u=n(4),c=n(3);var h=function(e){var t,n="cell";return e.open?e.hasMine?(n+=" cell_mine",t=i.a.createElement("span",{className:"cell__value cell__value_mine"},"\ud83d\udca3")):(n+=" cell_open",t=i.a.createElement("span",{"data-cell-value":e.value,className:"cell__value"},e.value||null)):e.hasFlag&&(t=i.a.createElement("span",{className:"cell__value cell__value_flag"},"\ud83d\udea9")),i.a.createElement("div",{className:n,"data-index":e.index},t)},m=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={grid:[],started:!1,locked:!1},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.initGrid()}},{key:"initGrid",value:function(){var e=Array(256).fill(null);e.forEach((function(e,t,n){n[t]={id:t,open:!1,has_mine:!1,has_flag:!1,value:null}})),this.setState({grid:e})}},{key:"fillGrid",value:function(e){var t=this.generateMineArr(this.getNeighborsIds(e,!0)),n=this.state.grid;n.forEach((function(e,n,a){-1!==t.indexOf(n)&&(e.has_mine=!0)})),this.setState({grid:n}),this.props.startTimer(Date.now())}},{key:"generateMineArr",value:function(e){for(var t=[];t.length<Number(this.props.mines);){var n=this.getRandomInteger(256);-1===t.indexOf(n)&&-1===e.indexOf(n)&&t.push(n)}return t.sort((function(e,t){return e>t})),t}},{key:"getNeighbors",value:function(e,t){var n=this.state.grid,a=[];return t&&a.push(n[e]),a.push(n[e-16],n[e+16]),e%16!==0&&a.push(n[e-1-16],n[e-1],n[e-1+16]),(e+1)%16!==0&&a.push(n[e+1-16],n[e+1],n[e+1+16]),(a=a.filter((function(e){return e&&e.id>=0&&e.id<256}))).sort((function(e,t){return e.id>t.id})),a}},{key:"getNeighborsIds",value:function(e,t){var n=[];return t&&n.push(e),n.push(e-16,e+16),e%16!==0&&n.push(e-1-16,e-1,e-1+16),(e+1)%16!==0&&n.push(e+1-16,e+1,e+1+16),(n=n.filter((function(e){return e>=0&&e<256}))).sort((function(e,t){return e>t})),n}},{key:"getRandomInteger",value:function(e){return Math.floor(Math.random()*Math.floor(e))}},{key:"openCell",value:function(e){var t,n=this.state.grid;n[e].has_flag||(n[e].open&&0!==n[e].value?this.tryChordCell(e):(t=this.getNeighbors(e),n[e].open=!0,n[e].has_mine?this.loseTheGame():(n[e].value=t.filter((function(e){return e.has_mine})).length,0===n[e].value&&this.tryChordCell(e),this.setState({grid:n}),this.checkVictory())))}},{key:"flagCell",value:function(e){var t=this.state.grid;t[e].open?this.tryAutoflagCell(e):(t[e].has_flag=!t[e].has_flag,this.setState({grid:t}),this.props.updateMineCount(t.filter((function(e){return e.has_flag})).length))}},{key:"tryChordCell",value:function(e){var t=this,n=this.state.grid,a=this.getNeighbors(e);a.filter((function(e){return e.has_flag})).length>=n[e].value&&a.forEach((function(e){e.open||t.openCell(e.id)}))}},{key:"tryAutoflagCell",value:function(e){var t=this,n=this.state.grid,a=this.getNeighbors(e);a.filter((function(e){return!e.open})).length===n[e].value&&a.forEach((function(e){e.open||e.has_flag||t.flagCell(e.id)}))}},{key:"checkVictory",value:function(){this.state.grid.filter((function(e){return!e.open})).length===this.props.mines&&(this.setState({locked:!0}),this.props.winTheGame())}},{key:"loseTheGame",value:function(){var e=this.state.grid;e.forEach((function(e){e.has_mine&&(e.open=!0)})),this.setState({grid:e,locked:!0}),this.props.loseTheGame()}},{key:"onGridMouseUp",value:function(e){var t,n=e.target.closest(".cell");if(n&&!this.state.locked)if(t=Number(n.dataset.index),0===e.button){if(!this.state.started)return this.fillGrid(t),this.setState({started:!0}),void this.openCell(t);this.openCell(t)}else 2===e.button&&this.flagCell(t)}},{key:"onGridMouseDown",value:function(e){}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"grid",onMouseDown:this.onGridMouseDown.bind(this),onMouseUp:this.onGridMouseUp.bind(this)},this.state.grid.map((function(e,t){return i.a.createElement(h,{key:e.id,index:e.id,open:e.open,value:e.value,hasFlag:e.has_flag,hasMine:e.has_mine})}))))}}]),n}(i.a.Component),d=(n(13),n(7)),f=n.n(d),v=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={victory:!1,game_timer:0,mine_count:40,grid_refresh_key:Date.now()},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){window.oncontextmenu=function(){return!1}}},{key:"startTimer",value:function(e){var t=this;this.timer=setInterval((function(){t.setState({game_timer:Math.round((Date.now()-e)/1e3)})}),1e3)}},{key:"stopTimer",value:function(){clearInterval(this.timer)}},{key:"resetTimer",value:function(){clearInterval(this.timer),this.setState({game_timer:0})}},{key:"updateMineCount",value:function(e){this.setState({mine_count:40-e})}},{key:"loseTheGame",value:function(){this.stopTimer()}},{key:"restartTheGame",value:function(){this.resetTimer(),this.setState({grid_refresh_key:Date.now(),mine_count:40})}},{key:"winTheGame",value:function(){this.stopTimer(),this.setState({victory:!0})}},{key:"render",value:function(){return i.a.createElement("div",{className:"game"},i.a.createElement(m,{key:this.state.grid_refresh_key,mines:40,updateMineCount:this.updateMineCount.bind(this),startTimer:this.startTimer.bind(this),loseTheGame:this.loseTheGame.bind(this),winTheGame:this.winTheGame.bind(this)}),i.a.createElement("div",{className:"sidemenu"},i.a.createElement("div",{className:"sidemenu__title"},"Mineswpr"),i.a.createElement("div",{className:"sidemenu__counters"},i.a.createElement("div",{className:"sidemenu__counter"},this.state.mine_count),i.a.createElement("div",{className:"sidemenu__counter"},this.state.game_timer)),i.a.createElement("div",{className:"sidemenu__restart"},i.a.createElement("button",{className:"sidemenu__restart-btn",onClick:this.restartTheGame.bind(this)},"Restart \u21bb")),this.state.victory?i.a.createElement("div",{className:"victory-image-container"},i.a.createElement("img",{className:"victory-image",src:f.a})):null))}}]),n}(i.a.Component);r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(v,null)),document.getElementById("root"))},7:function(e,t,n){e.exports=n.p+"static/media/victory.291a09be.jpg"},8:function(e,t,n){e.exports=n(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.781a7973.chunk.js.map